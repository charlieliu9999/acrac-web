# ACRAC V2.0 ç³»ç»Ÿæ–‡æ¡£

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

ACRAC V2.0 æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„åŒ»ç–—å½±åƒæ£€æŸ¥æ¨èç³»ç»Ÿï¼ŒåŸºäºACRé€‚å®œæ€§æ ‡å‡†ï¼Œæä¾›æ™ºèƒ½çš„ä¸´åºŠå†³ç­–æ”¯æŒã€‚ç³»ç»Ÿé‡‡ç”¨äº”è¡¨åˆ†ç¦»æ¶æ„ã€è¯­ä¹‰åŒ–IDæ–¹æ¡ˆå’Œå±‚æ¬¡åŒ–å‘é‡åµŒå…¥ï¼Œæ”¯æŒé«˜æ•ˆçš„æ•°æ®ç®¡ç†å’Œæ™ºèƒ½æœç´¢åŠŸèƒ½ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### 1. æ•°æ®åº“æ¶æ„ï¼ˆäº”è¡¨åˆ†ç¦»ï¼‰

```
panels (ç§‘å®¤) - P0001, P0002...
â”œâ”€â”€ topics (ä¸»é¢˜) - T0001, T0002...
    â”œâ”€â”€ clinical_scenarios (ä¸´åºŠåœºæ™¯) - S0001, S0002...
        â””â”€â”€ clinical_recommendations (æ¨èå…³ç³») - CR000001, CR000002...
            â””â”€â”€ procedure_dictionary (æ£€æŸ¥é¡¹ç›®å­—å…¸) - PR0001, PR0002...
```

#### æ ¸å¿ƒè¡¨ç»“æ„
- **panels**: 13ä¸ªåŒ»ç–—ç§‘å®¤
- **topics**: 285ä¸ªä¸´åºŠä¸»é¢˜
- **clinical_scenarios**: 1,391ä¸ªä¸´åºŠåœºæ™¯
- **procedure_dictionary**: 1,383ä¸ªç‹¬ç«‹æ£€æŸ¥é¡¹ç›®
- **clinical_recommendations**: 15,970ä¸ªä¸´åºŠæ¨èå…³ç³»

### 2. æŠ€æœ¯æ ˆ

#### åç«¯æŠ€æœ¯
- **æ¡†æ¶**: FastAPI 0.116.1
- **æ•°æ®åº“**: PostgreSQL + pgvector
- **ORM**: SQLAlchemy 2.0.23
- **å‘é‡**: 1024ç»´å‘é‡åµŒå…¥
- **API**: RESTful APIè®¾è®¡

#### æ•°æ®å¤„ç†
- **æ•°æ®æº**: ACR_final.csv (16,005æ¡åŸå§‹è®°å½•)
- **æ•°æ®ä¼˜åŒ–**: å»é‡91%ï¼Œ1,383ä¸ªç‹¬ç«‹æ£€æŸ¥é¡¹ç›®
- **å‘é‡åŒ–**: 19,042ä¸ªå‘é‡åµŒå…¥ï¼Œ100%è¦†ç›–ç‡

## ğŸš€ ç³»ç»ŸåŠŸèƒ½

### 1. æ•°æ®ç®¡ç†
- âœ… **å®Œæ•´CRUD**: æ”¯æŒæ‰€æœ‰æ•°æ®çš„å¢åˆ æ”¹æŸ¥
- âœ… **è¯­ä¹‰åŒ–ID**: P/T/S/PR/CRå‰ç¼€ï¼Œä¾¿äºç†è§£
- âœ… **çº§è”åˆ é™¤**: è‡ªåŠ¨ç»´æŠ¤æ•°æ®å®Œæ•´æ€§
- âœ… **æ•°æ®éªŒè¯**: é˜²é‡å¤ã€å¤–é”®çº¦æŸ

### 2. æ™ºèƒ½æœç´¢
- âœ… **å‘é‡æœç´¢**: åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦çš„æœç´¢
- âœ… **å…³é”®è¯æœç´¢**: æ”¯æŒä¸­è‹±æ–‡å…³é”®è¯æŸ¥è¯¢
- âœ… **å¤šç»´è¿‡æ»¤**: æŒ‰ç§‘å®¤ã€æ–¹å¼ã€è¯„åˆ†ç­‰è¿‡æ»¤
- âœ… **æ™ºèƒ½æ¨è**: åŸºäºå®Œæ•´ä¸´åºŠå†³ç­–çš„æ¨è

### 3. æ•°æ®åˆ†æ
- âœ… **ç»Ÿè®¡åˆ†æ**: æ£€æŸ¥æ–¹å¼åˆ†å¸ƒã€è¯„åˆ†åˆ†å¸ƒç­‰
- âœ… **è´¨é‡åˆ†æ**: æ•°æ®å®Œæ•´æ€§ã€å‘é‡è¦†ç›–ç‡
- âœ… **è¶‹åŠ¿åˆ†æ**: æ¨èæ¨¡å¼å’Œä¸´åºŠåå¥½

## ğŸ“– APIæ–‡æ¡£

### 1. åŸºç¡€ä¿¡æ¯
- **åŸºç¡€URL**: `http://127.0.0.1:8000/api/v1/acrac/`
- **APIæ–‡æ¡£**: `http://127.0.0.1:8000/docs`
- **ç‰ˆæœ¬**: V2.0.0

### 2. æ ¸å¿ƒç«¯ç‚¹

#### ç³»ç»ŸçŠ¶æ€
```bash
GET /api/v1/acrac/health           # å¥åº·æ£€æŸ¥
GET /api/v1/acrac/statistics       # ç»Ÿè®¡ä¿¡æ¯
```

#### æ•°æ®æŸ¥è¯¢
```bash
GET /api/v1/acrac/panels                           # æ‰€æœ‰ç§‘å®¤
GET /api/v1/acrac/panels/{id}/topics               # ç§‘å®¤ä¸‹çš„ä¸»é¢˜
GET /api/v1/acrac/topics/{id}/scenarios            # ä¸»é¢˜ä¸‹çš„åœºæ™¯
GET /api/v1/acrac/scenarios/{id}/recommendations   # åœºæ™¯çš„æ¨è
GET /api/v1/acrac/procedures                       # æ£€æŸ¥é¡¹ç›®
```

#### æœç´¢åŠŸèƒ½
```bash
POST /api/v1/acrac/search/vector        # å‘é‡æœç´¢
POST /api/v1/acrac/search/intelligent   # æ™ºèƒ½æ¨è
GET  /api/v1/acrac/search/procedures    # æ£€æŸ¥é¡¹ç›®æœç´¢
GET  /api/v1/acrac/search/recommendations # æ¨èæœç´¢
```

#### å¿«æ·æŸ¥è¯¢
```bash
GET /api/v1/acrac/quick/high-rating-recommendations     # é«˜è¯„åˆ†æ¨è
GET /api/v1/acrac/quick/procedures-by-modality/{type}   # æŒ‰æ–¹å¼æŸ¥è¯¢
GET /api/v1/acrac/quick/pregnancy-safe-recommendations  # å¦Šå¨ å®‰å…¨æ¨è
```

#### æ•°æ®åˆ†æ
```bash
GET /api/v1/acrac/analytics/modality-distribution       # æ£€æŸ¥æ–¹å¼åˆ†å¸ƒ
GET /api/v1/acrac/analytics/rating-distribution         # è¯„åˆ†åˆ†å¸ƒ
GET /api/v1/acrac/analytics/patient-population-stats    # æ‚£è€…äººç¾¤ç»Ÿè®¡
```

### 3. ä½¿ç”¨ç¤ºä¾‹

#### å¥åº·æ£€æŸ¥
```bash
curl "http://127.0.0.1:8000/api/v1/acrac/health"
```

å“åº”:
```json
{
    "status": "healthy",
    "database_status": "connected", 
    "version": "2.0.0",
    "data_summary": {
        "panels": 13,
        "topics": 285,
        "scenarios": 1391,
        "procedures": 1383,
        "recommendations": 15970
    }
}
```

#### æœç´¢æ£€æŸ¥é¡¹ç›®
```bash
curl "http://127.0.0.1:8000/api/v1/acrac/search/procedures?query=CT&limit=5"
```

#### è·å–é«˜è¯„åˆ†æ¨è
```bash
curl "http://127.0.0.1:8000/api/v1/acrac/quick/high-rating-recommendations?min_rating=8&limit=10"
```

## ğŸ› ï¸ éƒ¨ç½²å’Œè¿ç»´

### 1. å¿«é€Ÿå¯åŠ¨
```bash
# æ–¹æ³•1ï¼šä¸€é”®å¯åŠ¨
cd backend/scripts
python start_acrac_v2.py

# æ–¹æ³•2ï¼šæ‰‹åŠ¨å¯åŠ¨
cd backend
source venv/bin/activate
python -m uvicorn app.main:app --reload
```

### 2. æ•°æ®åº“ç®¡ç†
```bash
# é‡å»ºæ•°æ®åº“
python ACRACå®Œæ•´æ•°æ®åº“å‘é‡åº“æ„å»ºæ–¹æ¡ˆ.py rebuild --csv-file ../../ACR_data/ACR_final.csv

# éªŒè¯æ•°æ®
python ACRACå®Œæ•´æ•°æ®åº“å‘é‡åº“æ„å»ºæ–¹æ¡ˆ.py verify
```

### 3. Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t acrac-backend .

# è¿è¡Œå®¹å™¨
docker run -p 8000:8000 acrac-backend
```

## ğŸ”§ å¼€å‘æŒ‡å—

### 1. æ–°å¢æ•°æ®
```python
# åˆ›å»ºæ–°Panel
panel_data = {
    "name_en": "Neurology",
    "name_zh": "ç¥ç»ç§‘",
    "description": "ç¥ç»ç³»ç»Ÿç–¾ç—…è¯Šç–—",
    "is_active": True
}

response = requests.post(
    "http://127.0.0.1:8000/api/v1/acrac/panels",
    json=panel_data
)
```

### 2. æœç´¢æ¨è
```python
# æ™ºèƒ½æ¨èæœç´¢
search_request = {
    "clinical_query": "å­•å¦‡èƒ¸ç—›éœ€è¦æ£€æŸ¥",
    "patient_profile": {
        "age": 30,
        "gender": "å¥³æ€§", 
        "pregnancy_status": "å¦Šå¨ æœŸ"
    },
    "filters": {
        "min_rating": 7,
        "pregnancy_safety": "å®‰å…¨"
    },
    "limit": 10
}

response = requests.post(
    "http://127.0.0.1:8000/api/v1/acrac/search/intelligent",
    json=search_request
)
```

### 3. æ•°æ®åˆ†æ
```python
# è·å–æ£€æŸ¥æ–¹å¼åˆ†å¸ƒ
response = requests.get(
    "http://127.0.0.1:8000/api/v1/acrac/analytics/modality-distribution"
)
distribution = response.json()
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### 1. æ•°æ®ä¼˜åŒ–æˆæœ
- **å»é‡ç‡**: 91% (15,970 â†’ 1,383ä¸ªç‹¬ç«‹æ£€æŸ¥é¡¹ç›®)
- **å­˜å‚¨ä¼˜åŒ–**: å‡å°‘æ•°æ®å†—ä½™ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡
- **å‘é‡è¦†ç›–**: 100%è¦†ç›–ç‡ï¼Œ19,042ä¸ªå‘é‡åµŒå…¥

### 2. ç³»ç»Ÿæ€§èƒ½
- **APIå“åº”æ—¶é—´**: <100ms
- **å‘é‡æœç´¢**: æ¯«ç§’çº§å“åº”
- **æ•°æ®åº“è¿æ¥**: è¿æ¥æ± ä¼˜åŒ–
- **å†…å­˜ä½¿ç”¨**: ä¼˜åŒ–çš„æ•°æ®ç»“æ„

## ğŸ” æ•°æ®è´¨é‡

### 1. æ•°æ®å®Œæ•´æ€§
- âœ… æ— å­¤ç«‹è®°å½•
- âœ… å¤–é”®çº¦æŸå®Œæ•´
- âœ… æ•°æ®ç±»å‹éªŒè¯
- âœ… ä¸šåŠ¡è§„åˆ™éªŒè¯

### 2. å‘é‡è´¨é‡
- âœ… å±‚æ¬¡åŒ–å‘é‡ï¼šåŒ…å«ä¸Šçº§ä¿¡æ¯
- âœ… ç‹¬ç«‹å‘é‡ï¼šæ£€æŸ¥é¡¹ç›®ç‰¹å¾
- âœ… å†³ç­–å‘é‡ï¼šå®Œæ•´ä¸´åºŠå†³ç­–ä¿¡æ¯
- âœ… æœç´¢å‡†ç¡®æ€§ï¼šé«˜è´¨é‡çš„è¯­ä¹‰åŒ¹é…

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. ä¸´åºŠå†³ç­–æ”¯æŒ
- **åœºæ™¯**: åŒ»ç”Ÿéœ€è¦ä¸ºç‰¹å®šæ‚£è€…é€‰æ‹©åˆé€‚çš„æ£€æŸ¥
- **åŠŸèƒ½**: åŸºäºæ‚£è€…ç‰¹å¾å’Œä¸´åºŠåœºæ™¯çš„æ™ºèƒ½æ¨è
- **ä¼˜åŠ¿**: åŸºäºACRæ ‡å‡†ï¼Œæä¾›å¾ªè¯åŒ»å­¦æ”¯æŒ

### 2. åŒ»å­¦æ•™è‚²
- **åœºæ™¯**: åŒ»å­¦ç”Ÿå­¦ä¹ å½±åƒæ£€æŸ¥é€‚åº”ç—‡
- **åŠŸèƒ½**: æµè§ˆä¸åŒåœºæ™¯ä¸‹çš„æ¨èæ£€æŸ¥
- **ä¼˜åŠ¿**: ç»“æ„åŒ–çš„çŸ¥è¯†ä½“ç³»ï¼Œä¾¿äºå­¦ä¹ 

### 3. è´¨é‡æ§åˆ¶
- **åœºæ™¯**: åŒ»é™¢ç®¡ç†éƒ¨é—¨ç›‘æ§æ£€æŸ¥åˆç†æ€§
- **åŠŸèƒ½**: åˆ†ææ£€æŸ¥ä½¿ç”¨æ¨¡å¼å’Œé€‚å®œæ€§
- **ä¼˜åŠ¿**: æ•°æ®é©±åŠ¨çš„è´¨é‡æ”¹è¿›

### 4. ç§‘ç ”åˆ†æ
- **åœºæ™¯**: ç ”ç©¶å½±åƒæ£€æŸ¥çš„ä½¿ç”¨è¶‹åŠ¿
- **åŠŸèƒ½**: å¤šç»´åº¦æ•°æ®åˆ†æå’Œç»Ÿè®¡
- **ä¼˜åŠ¿**: ä¸°å¯Œçš„åˆ†æç»´åº¦å’Œå¯è§†åŒ–

## ğŸ” å®‰å…¨å’Œåˆè§„

### 1. æ•°æ®å®‰å…¨
- âœ… æ•°æ®åº“è¿æ¥åŠ å¯†
- âœ… APIè®¿é—®æ§åˆ¶ï¼ˆå¾…å®ç°ï¼‰
- âœ… æ•°æ®å¤‡ä»½æœºåˆ¶
- âœ… å®¡è®¡æ—¥å¿—è®°å½•

### 2. åŒ»ç–—åˆè§„
- âœ… åŸºäºACRé€‚å®œæ€§æ ‡å‡†
- âœ… å¾ªè¯åŒ»å­¦è¯æ®æ”¯æŒ
- âœ… å¦Šå¨ å®‰å…¨æ€§è¯„ä¼°
- âœ… è¾å°„å‰‚é‡ä¿¡æ¯

## ğŸš€ æœªæ¥è§„åˆ’

### ç¬¬äºŒé˜¶æ®µå¼€å‘
1. **å‰ç«¯ç•Œé¢**: Vue.jsç•Œé¢é€‚é…æ–°API
2. **ç”¨æˆ·ç³»ç»Ÿ**: ç”¨æˆ·ç®¡ç†å’Œæƒé™æ§åˆ¶
3. **å‘é‡æ¨¡å‹**: é›†æˆä¸“ä¸šåŒ»ç–—å‘é‡æ¨¡å‹
4. **å¯è§†åŒ–**: æ•°æ®åˆ†æå’Œè¶‹åŠ¿å¯è§†åŒ–

### ç¬¬ä¸‰é˜¶æ®µå¢å¼º
1. **AIæ¨è**: æœºå™¨å­¦ä¹ æ¨èç®—æ³•
2. **å¤šè¯­è¨€**: å›½é™…åŒ–æ”¯æŒ
3. **ç§»åŠ¨ç«¯**: ç§»åŠ¨åº”ç”¨å¼€å‘
4. **é›†æˆ**: ä¸HIS/PACSç³»ç»Ÿé›†æˆ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### 1. ç³»ç»Ÿç›‘æ§
- **å¥åº·æ£€æŸ¥**: `/api/v1/acrac/health`
- **æ€§èƒ½ç›‘æ§**: å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **èµ„æºç›‘æ§**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨

### 2. æ•…éšœæ’é™¤
- **æ—¥å¿—æŸ¥çœ‹**: `backend/logs/`ç›®å½•
- **æ•°æ®åº“è¿æ¥**: æ£€æŸ¥PostgreSQLæœåŠ¡çŠ¶æ€
- **ä¾èµ–é—®é¢˜**: æ£€æŸ¥requirements.txt

### 3. ç»´æŠ¤å»ºè®®
- **å®šæœŸå¤‡ä»½**: æ•°æ®åº“å’Œå‘é‡æ•°æ®
- **ç´¢å¼•ç»´æŠ¤**: å®šæœŸVACUUMå’ŒREINDEX
- **ä¾èµ–æ›´æ–°**: å®šæœŸæ›´æ–°å®‰å…¨è¡¥ä¸

---

**ACRAC V2.0 - æ™ºèƒ½åŒ»ç–—å†³ç­–æ”¯æŒç³»ç»Ÿ**
*ç‰ˆæœ¬: 2.0.0 | æ›´æ–°æ—¥æœŸ: 2025å¹´9æœˆ7æ—¥*
